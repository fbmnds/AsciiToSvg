namespace AsciiToSvg.Tests

module TxtFile =

  open AsciiToSvg.Common
  open AsciiToSvg.TxtFile



  let splitTxtResultExpected =
    [|("Logo", "{\"fill\":\"#88d\",\"a2s:delref\":true}")|],
        [|" .-[Logo]------------------.   ";
          " |                         |   ";
          " | .---.-. .-----. .-----. |   ";
          " | | .-. | +-->  | |  <--+ |    ";
          " | | '-' | |  <--+ +-->  | |  ";
          " | '---'-' '-----' '-----' |  ";
          " |  ascii     2      svg   |  ";
          " |                         |  ";
          " '-------------------------'  ";
          "  https://9vx.org/~dho/a2s/   ";
          "   "|]
  let splitTxtResult =
    @"../../TestTxtFiles/TestLogo.txt"
    |> readFile
    |> framedSplitTxt


  let makeFramedGridResultExpected =
    [|[|' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '.'; '-'; '['; 'L'; 'o'; 'g'; 'o'; ']'; '-'; '-'; '-'; '-'; '-';
        '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '.';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; '.'; '-'; '-'; '-'; '.'; '-'; '.'; ' '; '.'; '-'; '-';
        '-'; '-'; '-'; '.'; ' '; '.'; '-'; '-'; '-'; '-'; '-'; '.'; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; '|'; ' '; '.'; '-'; '.'; ' '; '|'; ' '; '+'; '-'; '-';
        '>'; ' '; ' '; '|'; ' '; '|'; ' '; ' '; '<'; '-'; '-'; '+'; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; '|'; ' '; '\''; '-'; '\''; ' '; '|'; ' '; '|'; ' '; ' ';
        '<'; '-'; '-'; '+'; ' '; '+'; '-'; '-'; '>'; ' '; ' '; '|'; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; '\''; '-'; '-'; '-'; '\''; '-'; '\''; ' '; '\''; '-'; '-';
        '-'; '-'; '-'; '\''; ' '; '\''; '-'; '-'; '-'; '-'; '-'; '\''; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; ' '; 'a'; 's'; 'c'; 'i'; 'i'; ' '; ' '; ' '; ' '; ' ';
        '2'; ' '; ' '; ' '; ' '; ' '; ' '; 's'; 'v'; 'g'; ' '; ' '; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '|'; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; '|';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; '\''; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-';
        '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '-'; '\'';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; ' '; 'h'; 't'; 't'; 'p'; 's'; ':'; '/'; '/'; '9'; 'v'; 'x'; '.';
        'o'; 'r'; 'g'; '/'; '~'; 'd'; 'h'; 'o'; '/'; 'a'; '2'; 's'; '/'; ' ';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '|];
      [|' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' '; ' ';
        ' '; ' '; ' '; ' '; ' '|]|]
  let makeFramedGridResult = splitTxtResult |> fun (a, b) -> b |> makeFramedGrid


  let matchPositionsExpected = [2; 25]
  let replaceOptionResultExpected =
    ([2; 25], "-----------------------------------------")
  let input = "--[Logo]-----------------[Logo]----------"
            //    01234567890123456789012345
  let matchPositionsResult = matchPositions "Logo" input
  let replaceOptionResult = replaceOption '-' "Logo" input
